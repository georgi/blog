<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Matthias Georgi</title>
    <meta name="Keywords" content="Matthias Georgi, Blog" />
    <meta http-equiv="Content-Language" content="English" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../index.rss" />
    <link rel="stylesheet" media="screen" type="text/css" href="../../style.css" />
    <link rel="stylesheet" href="../../zenburn.css">
    <script src="../../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div class="container">
      <div id="header" class="column span-13 last">
        <div id="title"><a href="../../index.html">Matthias Georgi</a></div>
      </div>

      <div class="content">
        <h1>Google-like Search Results Helper</h1>

<p>Representing your search results in a user-friendly way is a common
task among web developers. Google&#39;s approach is dead simple but really
effective. The matching text is highlighted and shown with its
context. This can be implemented in less than 20 lines of code which
you can include into you helper:</p>

<pre><code>def highlight_text(text, words)
  tokens = strip_tags(text).split
  sections = []
  words.each do |word|
    word = word.downcase
    tokens.each_with_index do |token, i|
      if token.downcase.include? word
        section = tokens[i-10, 20].join(&#39; &#39;)
        words.each do |word|
          section = highlight section, word
        end
        sections &lt;&lt; section + &#39; ... &#39;
        break if sections.size &gt; 3          
      end
    end
  end
  sections.join
end
</code></pre>

<p>First we remove the html tags of the text and split the text into
tokens. Then we iterate over the search words and for each matching
token we generate a section, which contains the highlighted word. This
is done until we hav at least 4 sections, which are finally joined and
ready to be included into the search result template.</p>

      </div>
    </div>
  </body>
</html>